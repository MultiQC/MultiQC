# MultiQC Default Template

This directory contains the default HTML template for MultiQC reports. The template uses Bootstrap 5.3.7 and custom styles/scripts bundled with Vite.

## Directory Structure

```
default/
├── src/
│   ├── js/
│   │   ├── main.js          # Entry point that imports all JS modules
│   │   └── ...              # MultiQC JavaScript modules
│   └── scss/
│       ├── main.scss        # Main file that imports Bootstrap and custom styles
│       └── custom.scss      # Custom MultiQC styles
├── compiled/                # Built assets (generated by Vite)
│   ├── css/
│   │   └── multiqc.min.css  # Bundled CSS (do not edit)
│   └── js/
│       └── multiqc.min.js   # Bundled JS (do not edit)
├── assets/                  # Third-party libraries
│   └── js/packages/         # jQuery, Plotly, etc. (kept separate)
├── node_modules/            # npm dependencies (not in git)
├── package.json             # npm configuration
└── vite.config.js           # Vite configuration
```

## Development Setup

1. Install dependencies:

   ```bash
   cd multiqc/templates/default
   npm install
   ```

2. Build assets with Vite:

   ```bash
   npm run build
   ```

3. Watch for changes during development:
   ```bash
   npm run watch
   ```

## Making Changes

### Styles

- Edit SCSS files in `src/scss/`
- `custom.scss` contains all custom MultiQC styles
- `main.scss` imports Bootstrap and custom styles

### JavaScript

- Edit JavaScript files in `src/js/`
- `main.js` is the entry point that imports all modules
- Bootstrap 5 is bundled with MultiQC custom JavaScript

### Build Process

Assets are automatically built when:

- You run `npm run build` manually
- You have `npm run watch` running
- You commit changes (via pre-commit hook)

### Plotly bundle

The Plotly bundle is created by cloning the Plotly repository and running the following:

```bash
npm run custom-bundle -- --traces bar,scatter,table,violin,heatmap,box
```

This generates a minified JavaScript file using [Custom Bundling](https://github.com/plotly/plotly.js/blob/master/CUSTOM_BUNDLE.md).
The resulting file is much bigger than importing all of Plotly, as we don't use very many different plot types.

For now it seems that tree-shaking does not work well for Plotly. See https://github.com/MultiQC/MultiQC/pull/3364 for implementation and discussion.

## Important Notes

- **Never edit files in `compiled/`** - they are automatically generated
- The bundled CSS includes Bootstrap 5.3.7 and all custom styles
- The bundled JS includes Bootstrap 5 and all MultiQC custom JavaScript
- Third-party libraries (jQuery, Plotly, etc.) are kept separate in `assets/js/packages/`
- The pre-commit hook ensures built assets are always up-to-date
- All assets are base64-encoded into the HTML report to make it standalone
